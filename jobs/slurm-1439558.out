cpu-bind=MASK - bp1-gpu001, task 4294967295 4294967295 [0]: mask 0x101 set
==>> input params: ['gpus=0,1,2,3', 'backbone=Cov-l', 'num_epochs=100', 'exp_id=Covnext-YOLO', 'freeze_backbone=True', 'coco_train=True', 'cov_pretrained=True', 'save_epoch=10', 'use_amp=True', 'val_intervals=2', 'data_num_workers=14', 'batch_size=64', 'random_size=[14,26]', 'input_size=[640,640]', 'test_size=[640,640]']
[INFO] change param: gpus 0 -> (0, 1, 2, 3) ('tuple')
[INFO] change param: backbone CSPDarknet-s -> Cov-l ('str')
[INFO] change param: num_epochs 300 -> 100 ('int')
[INFO] change param: exp_id gputest1 -> Covnext-YOLO ('str')
[INFO] change param: freeze_backbone False -> True ('bool')
[INFO] change param: coco_train False -> True ('bool')
[INFO] change param: cov_pretrained False -> True ('bool')
[INFO] change param: save_epoch 5 -> 10 ('int')
[INFO] same param: use_amp=True ('bool')
[INFO] same param: val_intervals=2 ('int')
[INFO] change param: data_num_workers 4 -> 14 ('int')
[INFO] change param: batch_size 24 -> 64 ('int')
[INFO] change param: random_size None -> [14, 26] ('list')
[INFO] same param: input_size=[640, 640] ('list')
[INFO] same param: test_size=[640, 640] ('list')
[INFO] re-change param: gpus [0, 1, 2, 3] to 0,1,2,3 'str' 

-------------------- final config: --------------------
{'exp_id': 'Covnext-YOLO', 'dataset_path': '/user/home/bq18557/scratch/COCO', 'backbone': 'Cov-l', 'input_size': [640, 640], 'random_size': [14, 26], 'test_size': [640, 640], 'gpus': [0, 1, 2, 3], 'batch_size': 64, 'val_batch_size': 4, 'master_batch_size': 16, 'num_epochs': 100, 'swin_pretrained': False, 'swin_weights_path': None, 'csp_pretrained': False, 'csp_weights_path': None, 'cov_pretrained': True, 'coco_train': True, 'freeze_backbone': True, 'label_name': ['person', 'bicycle', 'car', 'motorcycle', 'airplane', 'bus', 'train', 'truck', 'boat', 'traffic light', 'fire hydrant', 'stop sign', 'parking meter', 'bench', 'bird', 'cat', 'dog', 'horse', 'sheep', 'cow', 'elephant', 'bear', 'zebra', 'giraffe', 'backpack', 'umbrella', 'handbag', 'tie', 'suitcase', 'frisbee', 'skis', 'snowboard', 'sports ball', 'kite', 'baseball bat', 'baseball glove', 'skateboard', 'surfboard', 'tennis racket', 'bottle', 'wine glass', 'cup', 'fork', 'knife', 'spoon', 'bowl', 'banana', 'apple', 'sandwich', 'orange', 'broccoli', 'carrot', 'hot dog', 'pizza', 'donut', 'cake', 'chair', 'couch', 'potted plant', 'bed', 'dining table', 'toilet', 'tv', 'laptop', 'mouse', 'remote', 'keyboard', 'cell phone', 'microwave', 'oven', 'toaster', 'sink', 'refrigerator', 'book', 'clock', 'vase', 'scissors', 'teddy bear', 'hair drier', 'toothbrush'], 'reid_dim': 0, 'tracking_id_nums': None, 'warmup_lr': 0, 'basic_lr_per_img': 0.00015625, 'scheduler': 'yoloxwarmcos', 'no_aug_epochs': 15, 'min_lr_ratio': 0.05, 'weight_decay': 0.0005, 'warmup_epochs': 5, 'depth_wise': False, 'stride': [8, 16, 32], 'degrees': 10.0, 'translate': 0.1, 'scale': [0.1, 2], 'shear': 2.0, 'perspective': 0.0, 'enable_mixup': True, 'seed': None, 'mosaic_prob': 1.0, 'mixup_prob': 1.0, 'data_num_workers': 14, 'momentum': 0.9, 'vis_thresh': 0.3, 'load_model': '', 'ema': True, 'grad_clip': {'max_norm': 35, 'norm_type': 2}, 'print_iter': 10, 'val_intervals': 2, 'save_epoch': 10, 'resume': False, 'use_amp': True, 'cuda_benchmark': False, 'nms_thresh': 0.65, 'occupy_mem': False, 'cache': False, 'fold': None, 'rgb_means': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225], 'train_ann': '/user/home/bq18557/scratch/COCO/annotations/instances_train2017.json', 'val_ann': '/user/home/bq18557/scratch/COCO/annotations/instances_val2017.json', 'data_dir': '/user/home/bq18557/scratch/COCO', 'num_classes': 80, 'gpus_str': '0,1,2,3', 'chunk_sizes': [16, 16, 16, 16], 'root_dir': '/user/home/bq18557/Transformer-YOLOX', 'save_dir': '/user/home/bq18557/Transformer-YOLOX/exp/Covnext-YOLO'}
log file will be saved to /user/home/bq18557/Transformer-YOLOX/exp/Covnext-YOLO/logs_2022-04-17-01-08/log.txt
==>> loaded weights/mask_rcnn_convnext_tiny_1k_3x.pth
Used parameter:downsample_layers.0.0.weight
Used parameter:downsample_layers.0.0.bias
Used parameter:downsample_layers.0.1.weight
Used parameter:downsample_layers.0.1.bias
Used parameter:downsample_layers.1.0.weight
Used parameter:downsample_layers.1.0.bias
Used parameter:downsample_layers.1.1.weight
Used parameter:downsample_layers.1.1.bias
Used parameter:downsample_layers.2.0.weight
Used parameter:downsample_layers.2.0.bias
Used parameter:downsample_layers.2.1.weight
Used parameter:downsample_layers.2.1.bias
Used parameter:downsample_layers.3.0.weight
Used parameter:downsample_layers.3.0.bias
Used parameter:downsample_layers.3.1.weight
Used parameter:downsample_layers.3.1.bias
Used parameter:stages.0.0.gamma
Used parameter:stages.0.0.dwconv.weight
Used parameter:stages.0.0.dwconv.bias
Used parameter:stages.0.0.norm.weight
Used parameter:stages.0.0.norm.bias
Used parameter:stages.0.0.pwconv1.weight
Used parameter:stages.0.0.pwconv1.bias
Used parameter:stages.0.0.pwconv2.weight
Used parameter:stages.0.0.pwconv2.bias
Used parameter:stages.0.1.gamma
Used parameter:stages.0.1.dwconv.weight
Used parameter:stages.0.1.dwconv.bias
Used parameter:stages.0.1.norm.weight
Used parameter:stages.0.1.norm.bias
Used parameter:stages.0.1.pwconv1.weight
Used parameter:stages.0.1.pwconv1.bias
Used parameter:stages.0.1.pwconv2.weight
Used parameter:stages.0.1.pwconv2.bias
Used parameter:stages.0.2.gamma
Used parameter:stages.0.2.dwconv.weight
Used parameter:stages.0.2.dwconv.bias
Used parameter:stages.0.2.norm.weight
Used parameter:stages.0.2.norm.bias
Used parameter:stages.0.2.pwconv1.weight
Used parameter:stages.0.2.pwconv1.bias
Used parameter:stages.0.2.pwconv2.weight
Used parameter:stages.0.2.pwconv2.bias
Used parameter:stages.1.0.gamma
Used parameter:stages.1.0.dwconv.weight
Used parameter:stages.1.0.dwconv.bias
Used parameter:stages.1.0.norm.weight
Used parameter:stages.1.0.norm.bias
Used parameter:stages.1.0.pwconv1.weight
Used parameter:stages.1.0.pwconv1.bias
Used parameter:stages.1.0.pwconv2.weight
Used parameter:stages.1.0.pwconv2.bias
Used parameter:stages.1.1.gamma
Used parameter:stages.1.1.dwconv.weight
Used parameter:stages.1.1.dwconv.bias
Used parameter:stages.1.1.norm.weight
Used parameter:stages.1.1.norm.bias
Used parameter:stages.1.1.pwconv1.weight
Used parameter:stages.1.1.pwconv1.bias
Used parameter:stages.1.1.pwconv2.weight
Used parameter:stages.1.1.pwconv2.bias
Used parameter:stages.1.2.gamma
Used parameter:stages.1.2.dwconv.weight
Used parameter:stages.1.2.dwconv.bias
Used parameter:stages.1.2.norm.weight
Used parameter:stages.1.2.norm.bias
Used parameter:stages.1.2.pwconv1.weight
Used parameter:stages.1.2.pwconv1.bias
Used parameter:stages.1.2.pwconv2.weight
Used parameter:stages.1.2.pwconv2.bias
Used parameter:stages.2.0.gamma
Used parameter:stages.2.0.dwconv.weight
Used parameter:stages.2.0.dwconv.bias
Used parameter:stages.2.0.norm.weight
Used parameter:stages.2.0.norm.bias
Used parameter:stages.2.0.pwconv1.weight
Used parameter:stages.2.0.pwconv1.bias
Used parameter:stages.2.0.pwconv2.weight
Used parameter:stages.2.0.pwconv2.bias
Used parameter:stages.2.1.gamma
Used parameter:stages.2.1.dwconv.weight
Used parameter:stages.2.1.dwconv.bias
Used parameter:stages.2.1.norm.weight
Used parameter:stages.2.1.norm.bias
Used parameter:stages.2.1.pwconv1.weight
Used parameter:stages.2.1.pwconv1.bias
Used parameter:stages.2.1.pwconv2.weight
Used parameter:stages.2.1.pwconv2.bias
Used parameter:stages.2.2.gamma
Used parameter:stages.2.2.dwconv.weight
Used parameter:stages.2.2.dwconv.bias
Used parameter:stages.2.2.norm.weight
Used parameter:stages.2.2.norm.bias
Used parameter:stages.2.2.pwconv1.weight
Used parameter:stages.2.2.pwconv1.bias
Used parameter:stages.2.2.pwconv2.weight
Used parameter:stages.2.2.pwconv2.bias
Used parameter:stages.2.3.gamma
Used parameter:stages.2.3.dwconv.weight
Used parameter:stages.2.3.dwconv.bias
Used parameter:stages.2.3.norm.weight
Used parameter:stages.2.3.norm.bias
Used parameter:stages.2.3.pwconv1.weight
Used parameter:stages.2.3.pwconv1.bias
Used parameter:stages.2.3.pwconv2.weight
Used parameter:stages.2.3.pwconv2.bias
Used parameter:stages.2.4.gamma
Used parameter:stages.2.4.dwconv.weight
Used parameter:stages.2.4.dwconv.bias
Used parameter:stages.2.4.norm.weight
Used parameter:stages.2.4.norm.bias
Used parameter:stages.2.4.pwconv1.weight
Used parameter:stages.2.4.pwconv1.bias
Used parameter:stages.2.4.pwconv2.weight
Used parameter:stages.2.4.pwconv2.bias
Used parameter:stages.2.5.gamma
Used parameter:stages.2.5.dwconv.weight
Used parameter:stages.2.5.dwconv.bias
Used parameter:stages.2.5.norm.weight
Used parameter:stages.2.5.norm.bias
Used parameter:stages.2.5.pwconv1.weight
Used parameter:stages.2.5.pwconv1.bias
Used parameter:stages.2.5.pwconv2.weight
Used parameter:stages.2.5.pwconv2.bias
Used parameter:stages.2.6.gamma
Used parameter:stages.2.6.dwconv.weight
Used parameter:stages.2.6.dwconv.bias
Used parameter:stages.2.6.norm.weight
Used parameter:stages.2.6.norm.bias
Used parameter:stages.2.6.pwconv1.weight
Used parameter:stages.2.6.pwconv1.bias
Used parameter:stages.2.6.pwconv2.weight
Used parameter:stages.2.6.pwconv2.bias
Used parameter:stages.2.7.gamma
Used parameter:stages.2.7.dwconv.weight
Used parameter:stages.2.7.dwconv.bias
Used parameter:stages.2.7.norm.weight
Used parameter:stages.2.7.norm.bias
Used parameter:stages.2.7.pwconv1.weight
Used parameter:stages.2.7.pwconv1.bias
Used parameter:stages.2.7.pwconv2.weight
Used parameter:stages.2.7.pwconv2.bias
Used parameter:stages.2.8.gamma
Used parameter:stages.2.8.dwconv.weight
Used parameter:stages.2.8.dwconv.bias
Used parameter:stages.2.8.norm.weight
Used parameter:stages.2.8.norm.bias
Used parameter:stages.2.8.pwconv1.weight
Used parameter:stages.2.8.pwconv1.bias
Used parameter:stages.2.8.pwconv2.weight
Used parameter:stages.2.8.pwconv2.bias
Used parameter:stages.3.0.gamma
Used parameter:stages.3.0.dwconv.weight
Used parameter:stages.3.0.dwconv.bias
Used parameter:stages.3.0.norm.weight
Used parameter:stages.3.0.norm.bias
Used parameter:stages.3.0.pwconv1.weight
Used parameter:stages.3.0.pwconv1.bias
Used parameter:stages.3.0.pwconv2.weight
Used parameter:stages.3.0.pwconv2.bias
Used parameter:stages.3.1.gamma
Used parameter:stages.3.1.dwconv.weight
Used parameter:stages.3.1.dwconv.bias
Used parameter:stages.3.1.norm.weight
Used parameter:stages.3.1.norm.bias
Used parameter:stages.3.1.pwconv1.weight
Used parameter:stages.3.1.pwconv1.bias
Used parameter:stages.3.1.pwconv2.weight
Used parameter:stages.3.1.pwconv2.bias
Used parameter:stages.3.2.gamma
Used parameter:stages.3.2.dwconv.weight
Used parameter:stages.3.2.dwconv.bias
Used parameter:stages.3.2.norm.weight
Used parameter:stages.3.2.norm.bias
Used parameter:stages.3.2.pwconv1.weight
Used parameter:stages.3.2.pwconv1.bias
Used parameter:stages.3.2.pwconv2.weight
Used parameter:stages.3.2.pwconv2.bias
Used parameter:norm0.weight
Used parameter:norm0.bias
Used parameter:norm1.weight
Used parameter:norm1.bias
Used parameter:norm2.weight
Used parameter:norm2.bias
Used parameter:norm3.weight
Used parameter:norm3.bias
Cov weights loaded and frozen
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
YOLOX                                              --
├─ConvNeXt: 1-1                                    --
│    └─ModuleList: 2-1                             --
│    │    └─Sequential: 3-1                        (4,896)
│    │    └─Sequential: 3-2                        (74,112)
│    │    └─Sequential: 3-3                        (295,680)
│    │    └─Sequential: 3-4                        (1,181,184)
│    └─ModuleList: 2-2                             --
│    │    └─Sequential: 3-5                        (237,888)
│    │    └─Sequential: 3-6                        (918,144)
│    │    └─Sequential: 3-7                        (10,817,280)
│    │    └─Sequential: 3-8                        (14,289,408)
│    └─LayerNorm: 2-3                              (192)
│    └─LayerNorm: 2-4                              (384)
│    └─LayerNorm: 2-5                              (768)
│    └─LayerNorm: 2-6                              (1,536)
├─YOLOXPAFPN: 1-2                                  --
│    └─Upsample: 2-7                               --
│    └─BaseConv: 2-8                               --
│    │    └─Conv2d: 3-9                            294,912
│    │    └─BatchNorm2d: 3-10                      768
│    │    └─SiLU: 3-11                             --
│    └─CSPLayer: 2-9                               --
│    │    └─BaseConv: 3-12                         147,840
│    │    └─BaseConv: 3-13                         147,840
│    │    └─BaseConv: 3-14                         148,224
│    │    └─Sequential: 3-15                       1,108,224
│    └─BaseConv: 2-10                              --
│    │    └─Conv2d: 3-16                           73,728
│    │    └─BatchNorm2d: 3-17                      384
│    │    └─SiLU: 3-18                             --
│    └─CSPLayer: 2-11                              --
│    │    └─BaseConv: 3-19                         37,056
│    │    └─BaseConv: 3-20                         37,056
│    │    └─BaseConv: 3-21                         37,248
│    │    └─Sequential: 3-22                       277,632
│    └─BaseConv: 2-12                              --
│    │    └─Conv2d: 3-23                           331,776
│    │    └─BatchNorm2d: 3-24                      384
│    │    └─SiLU: 3-25                             --
│    └─CSPLayer: 2-13                              --
│    │    └─BaseConv: 3-26                         74,112
│    │    └─BaseConv: 3-27                         74,112
│    │    └─BaseConv: 3-28                         148,224
│    │    └─Sequential: 3-29                       1,108,224
│    └─BaseConv: 2-14                              --
│    │    └─Conv2d: 3-30                           1,327,104
│    │    └─BatchNorm2d: 3-31                      768
│    │    └─SiLU: 3-32                             --
│    └─CSPLayer: 2-15                              --
│    │    └─BaseConv: 3-33                         295,680
│    │    └─BaseConv: 3-34                         295,680
│    │    └─BaseConv: 3-35                         591,360
│    │    └─Sequential: 3-36                       4,428,288
├─YOLOXHead: 1-3                                   --
│    └─ModuleList: 2-16                            --
│    │    └─BaseConv: 3-37                         49,664
│    │    └─BaseConv: 3-38                         98,816
│    │    └─BaseConv: 3-39                         197,120
│    └─ModuleList: 2-17                            --
│    │    └─Sequential: 3-40                       1,180,672
│    │    └─Sequential: 3-41                       1,180,672
│    │    └─Sequential: 3-42                       1,180,672
│    └─ModuleList: 2-18                            --
│    │    └─Sequential: 3-43                       1,180,672
│    │    └─Sequential: 3-44                       1,180,672
│    │    └─Sequential: 3-45                       1,180,672
│    └─ModuleList: 2-19                            --
│    │    └─Conv2d: 3-46                           20,560
│    │    └─Conv2d: 3-47                           20,560
│    │    └─Conv2d: 3-48                           20,560
│    └─ModuleList: 2-20                            --
│    │    └─Conv2d: 3-49                           1,028
│    │    └─Conv2d: 3-50                           1,028
│    │    └─Conv2d: 3-51                           1,028
│    └─ModuleList: 2-21                            --
│    │    └─Conv2d: 3-52                           257
│    │    └─Conv2d: 3-53                           257
│    │    └─Conv2d: 3-54                           257
├─YOLOXLoss: 1-4                                   --
│    └─L1Loss: 2-22                                --
│    └─BCEWithLogitsLoss: 2-23                     --
│    └─IOUloss: 2-24                               --
===========================================================================
Total params: 46,296,639
Trainable params: 18,481,791
Non-trainable params: 27,814,848
===========================================================================
creating data loaders, start time: 1650154111.9966564
==> Loading train2017 annotation /user/home/bq18557/scratch/COCO/annotations/instances_train2017.json
loading annotations into memory...
Done (t=15.24s)
creating index...
index created!
images number 118287
==> Loading val2017 annotation /user/home/bq18557/scratch/COCO/annotations/instances_val2017.json
loading annotations into memory...
Done (t=0.52s)
creating index...
index created!
images number 5000
classes index: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 67, 70, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 84, 85, 86, 87, 88, 89, 90]
class names in dataset: ['person', 'bicycle', 'car', 'motorcycle', 'airplane', 'bus', 'train', 'truck', 'boat', 'traffic light', 'fire hydrant', 'stop sign', 'parking meter', 'bench', 'bird', 'cat', 'dog', 'horse', 'sheep', 'cow', 'elephant', 'bear', 'zebra', 'giraffe', 'backpack', 'umbrella', 'handbag', 'tie', 'suitcase', 'frisbee', 'skis', 'snowboard', 'sports ball', 'kite', 'baseball bat', 'baseball glove', 'skateboard', 'surfboard', 'tennis racket', 'bottle', 'wine glass', 'cup', 'fork', 'knife', 'spoon', 'bowl', 'banana', 'apple', 'sandwich', 'orange', 'broccoli', 'carrot', 'hot dog', 'pizza', 'donut', 'cake', 'chair', 'couch', 'potted plant', 'bed', 'dining table', 'toilet', 'tv', 'laptop', 'mouse', 'remote', 'keyboard', 'cell phone', 'microwave', 'oven', 'toaster', 'sink', 'refrigerator', 'book', 'clock', 'vase', 'scissors', 'teddy bear', 'hair drier', 'toothbrush']
data loaders created in: 50.09808921813965
shuffle images list in /user/home/bq18557/scratch/COCO/annotations/instances_train2017.json
multi size training: [[448, 448], [480, 480], [512, 512], [544, 544], [576, 576], [608, 608], [640, 640], [672, 672], [704, 704], [736, 736], [768, 768], [800, 800]]
/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 14 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Traceback (most recent call last):
  File "train.py", line 213, in <module>
    main()
  File "train.py", line 200, in main
    train(model, scaler, train_loader, val_loader, optimizer, lr_scheduler, start_epoch, no_aug)
  File "train.py", line 123, in train
    loss_dict_train, _ = run_epoch(model, optimizer, scaler, ema, "train", epoch, train_loader,
  File "train.py", line 50, in run_epoch
    _, loss_stats = model_with_loss(inps, targets=targets)
  File "/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 168, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 178, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/nn/parallel/parallel_apply.py", line 86, in parallel_apply
    output.reraise()
  File "/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
AssertionError: Caught AssertionError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/user/home/bq18557/Transformer-YOLOX/models/yolox.py", line 175, in forward
    neck_feats = self.neck(body_feats)
  File "/user/home/bq18557/work-env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/user/home/bq18557/Transformer-YOLOX/models/neck/yolo_fpn.py", line 888, in forward
    assert len(blocks) == len(self.in_channels)
AssertionError

